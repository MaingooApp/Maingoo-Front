<div [class]="
    'fixed bg-white/95 dark:bg-surface-800/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200/50 dark:border-surface-700/50 z-[1001] w-96 overflow-hidden flex flex-col transition-all duration-[400ms] ease-[cubic-bezier(0.05,0.74,0.2,0.99)] ' +
    (layoutService.isProfilePanelActive() ? 'translate-x-0 opacity-100' : 'translate-x-[calc(100%+2rem)] opacity-0')
  " style="right: 2rem; top: 6rem; height: auto; max-height: min(400px, calc(100vh - 10rem))">
  <!-- Header -->
  <div
    class="flex items-center justify-between px-4 py-3 border-b border-gray-200/50 dark:border-surface-700/50 bg-gradient-to-r from-[#F0F7F4]/80 to-white/80 dark:from-surface-900/80 dark:to-surface-800/80 backdrop-blur-sm">
    <div class="flex items-center gap-2">
      <app-icon name="person" size="sm" class="text-[#6B9E86]"></app-icon>
      <h3 class="text-xs font-bold text-[#1A3C34] dark:text-surface-0 uppercase tracking-wider">Perfil</h3>
    </div>
  </div>

  <!-- Content -->
  <div
    class="p-3 flex flex-col gap-1 bg-gradient-to-b from-white/50 to-gray-50/50 dark:from-surface-800/50 dark:to-surface-900/50 overflow-y-auto">
    <!-- Mi Perfil -->
    <button type="button" routerLink="/miperfil" (click)="toggleProfile()"
      class="w-full px-4 py-3 text-left text-[#1A3C34] dark:text-surface-0 hover:bg-white dark:hover:bg-surface-700 hover:shadow-sm flex items-center gap-3 transition-all rounded-xl group">
      <div
        class="w-9 h-9 rounded-lg bg-[#F0F7F4]/80 dark:bg-surface-700/80 flex items-center justify-center group-hover:bg-[#6B9E86]/20 transition-colors">
        <app-icon name="person" size="md" class="text-[#6B9E86]"></app-icon>
      </div>
      <span class="text-sm font-medium group-hover:text-[#6B9E86] transition-colors">Mi perfil</span>
    </button>

    <!-- Configuración (Móvil: Ir a cambiar contraseña) -->
    <button type="button" routerLink="/miperfil" fragment="change-password" (click)="toggleProfile()"
      class="md:hidden w-full px-4 py-3 text-left text-[#1A3C34] dark:text-surface-0 hover:bg-white dark:hover:bg-surface-700 hover:shadow-sm flex items-center gap-3 transition-all rounded-xl group">
      <div
        class="w-9 h-9 rounded-lg bg-[#F0F7F4]/80 dark:bg-surface-700/80 flex items-center justify-center group-hover:bg-[#6B9E86]/20 transition-colors">
        <app-icon name="settings" size="md" class="text-[#6B9E86]"></app-icon>
      </div>
      <span class="text-sm font-medium group-hover:text-[#6B9E86] transition-colors">Configuración</span>
    </button>

    <!-- Configuración (Desktop: Abrir panel ajustes) -->
    <button type="button" (click)="openSettings(); toggleProfile()"
      class="hidden md:flex w-full px-4 py-3 text-left text-[#1A3C34] dark:text-surface-0 hover:bg-white dark:hover:bg-surface-700 hover:shadow-sm items-center gap-3 transition-all rounded-xl group">
      <div
        class="w-9 h-9 rounded-lg bg-[#F0F7F4]/80 dark:bg-surface-700/80 flex items-center justify-center group-hover:bg-[#6B9E86]/20 transition-colors">
        <app-icon name="settings" size="md" class="text-[#6B9E86]"></app-icon>
      </div>
      <span class="text-sm font-medium group-hover:text-[#6B9E86] transition-colors">Configuración</span>
    </button>

    <!-- Tema -->
    <button type="button" (click)="toggleDarkMode()"
      class="w-full px-4 py-3 text-left text-[#1A3C34] dark:text-surface-0 hover:bg-white dark:hover:bg-surface-700 hover:shadow-sm flex items-center gap-3 transition-all rounded-xl group">
      <div
        class="w-9 h-9 rounded-lg bg-[#F0F7F4]/80 dark:bg-surface-700/80 flex items-center justify-center group-hover:bg-[#6B9E86]/20 transition-colors">
        <app-icon [name]="layoutService.isDarkTheme() ? 'dark_mode' : 'light_mode'" size="md"
          class="text-[#6B9E86]"></app-icon>
      </div>
      <span class="text-sm font-medium group-hover:text-[#6B9E86] transition-colors">{{
        layoutService.isDarkTheme() ? 'Tema claro' : 'Tema oscuro'
        }}</span>
    </button>

    <div class="h-px bg-gradient-to-r from-transparent via-gray-200 dark:via-surface-700 to-transparent my-2"></div>

    <!-- Salir -->
    <button type="button" (click)="logout()"
      class="w-full px-4 py-3 text-left text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 hover:shadow-sm flex items-center gap-3 transition-all rounded-xl group">
      <div
        class="w-9 h-9 rounded-lg bg-red-50 dark:bg-red-900/20 flex items-center justify-center group-hover:bg-red-100 dark:group-hover:bg-red-900/30 transition-colors">
        <app-icon name="logout" size="md" class="text-red-600 dark:text-red-400"></app-icon>
      </div>
      <span class="text-sm font-semibold">Cerrar sesión</span>
    </button>
  </div>
</div>