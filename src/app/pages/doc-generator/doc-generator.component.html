<p-toast />
<!-- Salgan los mensajitos por arriba flotando arriba a la derecha -->

<div class="card grid grid-cols-12 gap-8">
    <!-- Rejilla de 12 -->
    <div class="col-span-12 lg:col-span-8">
        <p-iconfield>
            <p-inputicon class="pi pi-search" />
            <input pInputText type="text" placeholder="Buscar por nombre o etiqueta..." [(ngModel)]="documentSearchQuery" (keyup)="onDocumentSearch()" class="w-full" />
            <p-inputicon class="pi pi-times cursor-pointer" (click)="documentSearchQuery = ''; onDocumentSearch()" *ngIf="documentSearchQuery" />
        </p-iconfield>
    </div>
    <div class="col-span-12 lg:col-span-4">
        <div class="flex justify-start items-center gap-2">
            <button
                *ngFor="let tag of availableTags"
                type="button"
                (click)="toggleTagFilter(tag.name)"
                [class]="'text-xs font-semibold px-3 py-2 rounded-full border cursor-pointer ' + tag.color + (isTagFilterActive(tag.name) ? ' ring-2 ring-offset-1 ring-indigo-400 shadow-md' : ' opacity-70') + ' flex items-center'"
            >
                <i [class]="'pi ' + (isTagFilterActive(tag.name) ? 'pi-check-circle' : 'pi-circle') + ' mr-1'"></i>
                {{ tag.name }}
            </button>
            <button *ngIf="selectedTagFilters.length > 0 || documentSearchQuery" pButton type="button" icon="pi pi-filter-slash" label="Limpiar" class="p-button-text p-button-sm" (click)="clearAllFilters()"></button>
        </div>

        <!-- Clear Filters -->
    </div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-stretch">
    <!-- Registro de Temperaturas Card -->
    <p-card *ngIf="isDocumentVisible('temperatures')">
        <ng-template pTemplate="header">
            <div class="rounded-tl-lg rounded-tr-lg">
                <div class="p-6">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="bg-blue-100 rounded-full p-3 flex items-center justify-center">
                            <img src="assets/icons/temperature.svg" alt="Temperaturas" class="w-6 h-6" style="filter: invert(27%) sepia(51%) saturate(2878%) hue-rotate(200deg) brightness(104%) contrast(97%)" />
                        </div>
                        <h3 class="text-xl font-semibold m-0">Registro Temperaturas</h3>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <span *ngFor="let tag of documentCards[1].tags" class="text-xs font-semibold px-3 py-1.5 rounded-full bg-blue-100 text-blue-800 border border-blue-200">
                            {{ tag }}
                        </span>
                    </div>
                </div>
            </div>
        </ng-template>

        <!-- Empty State -->
        <div *ngIf="cameras.length === 0" class="text-center text-gray-400">
            <p class="text-sm">Sin registros</p>
        </div>

        <!-- Cameras List -->
        <div *ngIf="cameras.length > 0" class="space-y-3">
            <div *ngFor="let camera of cameras" class="border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-sm">
                <div class="flex items-center justify-between mb-3">
                    <!-- Camera Info -->
                    <div class="flex items-center gap-3">
                        <div class="bg-gray-100 rounded-lg p-2">
                            <img [src]="getCameraIcon(camera.type)" [alt]="camera.name" class="w-5 h-5" style="filter: invert(27%) sepia(51%) saturate(2878%) hue-rotate(200deg) brightness(104%) contrast(97%)" />
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 text-sm">{{ camera.name }}</h4>
                            <p class="text-xs text-gray-500">{{ getCameraTypeLabel(camera.type) }}</p>
                        </div>
                    </div>

                    <!-- Temperature Display -->
                    <div class="text-right">
                        <div *ngIf="camera.lastTemp" class="text-xl font-bold text-blue-600">{{ camera.lastTemp }}°C</div>
                        <div *ngIf="!camera.lastTemp" class="text-xs text-gray-400">Sin registros</div>
                        <div *ngIf="camera.lastCheck" class="text-xs text-gray-500 mt-1">
                            {{ camera.lastCheck | date: 'short' }}
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="grid grid-cols-2 gap-2">
                    <button pButton type="button" label="Ver Detalle" icon="pi pi-eye" severity="secondary" [outlined]="true" class="w-full text-xs" (click)="openTemperatureRegistration(camera)"></button>
                    <button pButton type="button" label="Registrar Temp." icon="pi pi-thermometer" severity="success" class="w-full text-xs" (click)="openQuickTemperatureRegistration(camera)"></button>
                </div>
            </div>
        </div>

        <ng-template pTemplate="footer">
            <button pButton type="button" label="Añadir Cámara Frigorífica" icon="pi pi-plus" severity="success" [outlined]="true" class="w-full" (click)="addNewCamera()"></button>
        </ng-template>
    </p-card>

    <!-- Registro de Cambios de Aceite Card -->
    <p-card *ngIf="isDocumentVisible('oil')">
        <ng-template pTemplate="header">
            <div class="rounded-tl-lg rounded-tr-lg">
                <div class="p-6">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="bg-blue-100 rounded-full p-3 flex items-center justify-center">
                            <img src="assets/icons/droplet-half-2.svg" alt="Cambios de Aceite" class="w-6 h-6" style="filter: invert(27%) sepia(51%) saturate(2878%) hue-rotate(200deg) brightness(104%) contrast(97%)" />
                        </div>
                        <h3 class="text-xl font-semibold m-0">Cambios de Aceite</h3>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <span *ngFor="let tag of documentCards[1].tags" class="text-xs font-semibold px-3 py-1.5 rounded-full bg-blue-100 text-blue-800 border border-blue-200">
                            {{ tag }}
                        </span>
                    </div>
                </div>
            </div>
        </ng-template>

        <div class="text-center text-gray-400">
            <p class="text-sm">Sin registros</p>
        </div>

        <ng-template pTemplate="footer">
            <button pButton type="button" label="Añadir Freidora" icon="pi pi-plus" severity="success" [outlined]="true" class="w-full" (click)="addNewFryer()"></button>
        </ng-template>
    </p-card>
</div>
