<div *ngIf="facturas.length === 0; else tablaFacturas" class="bg-white rounded-xl p-10 shadow-md text-center">
    <i class="pi pi-inbox text-gray-300 mb-6" style="font-size: 6rem"></i>
    <h2 class="text-2xl font-semibold text-gray-700 mb-2">No hay facturas registradas</h2>
    <p class="text-gray-500">Cuando registres una factura, aparecerá aquí.</p>
</div>

<ng-template #tablaFacturas>
    <div class="flex flex-col md:flex-row gap-8">
        <div class="md:w-full">
            <div class="card flex flex-col gap-4">
                <h2 class="text-2xl font-bold">Upload albarán</h2>
                <div class="flex flex-col gap-4 items-center justify-center">
                    <p-fileupload
                        #fu
                        mode="advanced"
                        name="demo[]"
                        [customUpload]="true"
                        accept="image/*,application/pdf"
                        maxFileSize="5000000"
                        [disabled]="cargando"
                        (uploadHandler)="onUpload($event)"
                        chooseLabel="Elegir"
                        uploadLabel="Subir"
                        chooseIcon="pi pi-upload"
                        uploadIcon="pi pi-check"
                    />
                </div>
            </div>
        </div>
    </div>
    <div class="px-6 py-4">
        <div class="bg-white rounded-xl shadow-md p-6">
            
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-semibold text-surface-900 flex items-center gap-2">
                    <i class="pi pi-file" style="font-size: 1.5rem"></i>
                    Facturas registradas
                </h2>

                <!-- Botón a la derecha -->
                <button pButton label="Exportar imagenes facturas" icon="pi pi-share-alt" severity="info" (click)="exportarFacturas()"></button>
            </div>

            <app-tabla-dinamica
                [data]="facturas"
                [columns]="columnas"
                [loading]="loading"
                [globalFilterFields]="['supplier.name', 'invoiceNumber']"
                [actions]="acciones"
                (actionClick)="handleAccion($event)"
                [exportPdf]="true"
                [exportFilename]="'facturas'"
            >
            </app-tabla-dinamica>
        </div>
    </div>
</ng-template>
<p-dialog [(visible)]="mostrarModalExportar" modal header="Exportar imagenes de las facturas" [style]="{ width: '400px' }" [closable]="true">
    <div class="flex flex-col gap-4">
        <p>¿Qué deseas hacer con las facturas filtradas?</p>

        <div class="flex justify-center gap-2">
            <button pButton label="Descargar ZIP" icon="pi pi-download" (click)="descargarZip()" severity="success" [loading]="exportando" [disabled]="exportando"></button>
            <button pButton label="Enviar por correo" icon="pi pi-envelope" (click)="mostrarInputCorreo = true" severity="info" [disabled]="exportando" [loading]="exportando"></button>
        </div>

        <div *ngIf="mostrarInputCorreo" class="flex flex-col gap-2">
            <label for="correo">Correo de destino</label>
            <input pInputText id="correo" type="email" [(ngModel)]="correoDestino" placeholder="ejemplo@correo.com" />
            <button pButton label="Enviar ahora" icon="pi pi-send" (click)="enviarPorCorreo()" severity="primary" [disabled]="!correoDestino || exportando" [loading]="exportando"></button>
        </div>
    </div>
</p-dialog>
